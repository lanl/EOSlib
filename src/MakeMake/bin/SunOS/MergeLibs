#!/bin/sh

cdir=`pwd`
FullPath() {
	case "$1" in
	/*)
		echo $1;;
	*)
		echo $cdir/$1;;
	esac
}

lib=`FullPath $1`
shift

rm -fr /tmp/merge$$
mkdir /tmp/merge$$
cd /tmp/merge$$

for file
do
        f=`FullPath $file`
	if ( ar x $f )
	then
		chmod a-w *.o
	else
		cd ..
		status=$?
		rm -rf /tmp/merge$$
		exit $status
	fi
done

chmod o+w *.o
ar ru  $lib *.o
cd ..
rm -rf /tmp/merge$$

