#
# Validation HE used in trilab_mader test
# ---------------------------------------
# Products CJ isentrope with gamma = 3
# BKW::VHE is NOT ideal gas: PV = (gamma-1)e
# HEburn::VHE is NOT ideal HE EOS: PV = (gamma-1)e + lambda*Q
#
EOS:UsUp=VHE; units=hydro::HiP
{
# used in trilab_mader test
# teos.in matid 152777
    P_vac = 1.e-8
    rho0 = 1.875            # g/cm^3
    P0 = 1.0e-6             # Mb
    T0 = 300                # degrees K
    Cv = 0.3/23.89e3        # 0.3 cal/g -> (Mb*cc/g)/K
    G0 = G1 = 1.5           # Gamma   
    c0= 0.24
    s = 2.05
}
#
EOS:BKW=VHE; units=hydro::HiP
{
# used in trilab_mader test
# teos.in matid 152777
# CJ isentrope with gamma=3
    P_vac = 1.e-8
    V0 = 1/1.875
    e0 = 0
    de = 0.1
    Pn(1)=-0.3952844858e+01,-3.0000000000e+00,0.0,0.0,0.0
    en(1)=-0.16306439638E+01, 0.49699646235E+00, 0.79287730157E-01, 0.5535291507E-02, 0.1380517642E-03 
    Tn(1)= 7.0701188522e+00, -5.5765935177e-01, 8.9212397816e-02, 3.9511813908e-03, -3.2803583034e-02
    Cv = 0.5/23.89e3        # 0.5 cal/g -> (Mb*cc/g)/K
}
#
#  VHE with Arrhenius rate
#
HErate:Arrhenius=VHE; units=hydro::std
{
    tol   = 1.e-6
    n   =  1                # reaction order
    T_a =  10e3/1.987       # Ea(cal/mole) / R = 5033 K
    k   =  1.e3             # per microsec
    T_cutoff = 400
}
EOS:HEburn=VHE.ar; units=hydro::std
{
# used in trilab_mader test
    P_vac = 1.e-6
    OneDFunc_abs_tol = 1e-5
    OneDFunc_rel_tol = 1e-6
    ODE_epsilon      = 1e-6
    #
    PTtol = 1.e-6
    #
    lambda = 0  # all reactants
    reactants = "UsUp::VHE"
    products  = "BKW::VHE"
    HErate    = "Arrhenius::VHE";    
}
#
#  VHE with Ignition and Growth
#
HErate:IgnitionGrowth=VHE; units=hydro::HiP
{
# Ref. Sideways Plate Push Test for Detonating Solid Explosives
#   C M Tarver, W. C. Tao and C. G. Lee
#   Propellants, Explosives, Pyrotechnics 21 (1996) pp, 238--246
# LX-14 = 95 % HMX + 5 % Estane, Table 2
#
#  (d/dt)lambda = I*(1-lambda)^b*(rho/rho_0-1-a)^x, for lambda < lambda_igmax
#           + G1*(1-lambda)^c * lambda^d * P^y,     for lambda < lambda_G1max
#           + G2*(1-lambda)^e * lambda^g * P^z,     for lambda_G2min < lambda
    tol  = 1.e-5
    rho0 = 1.875            # g/cm^3
    lambda_igmax = 0.02
    I =  7.43e9             # 1/microsec
    a =  0
    b =  0.667
    x = 20.0
    lambda_G1max = 0.80
    y  =   2.0
    G1 = 175.               # 1/microsec for G1*P^y
    c  =   0.667
    d  =   0.111
    lambda_G2min = 0.80
    z  =  1.0
    G2 = 10.                # 1/microsec for G2*P^z
    e  =  0.667
    g  =  0.667
}
EOS:HEburn=VHE.ig; units=hydro::std
{
    P_vac = 1.e-6
    OneDFunc_abs_tol = 1e-5
    OneDFunc_rel_tol = 1e-6
    ODE_epsilon      = 1e-6
    #
    PTtol = 1.e-6
    #
    lambda = 0  # all reactants
    reactants = "UsUp::VHE"
    products  = "BKW::VHE"
    HErate    = "IgnitionGrowth::VHE";    
}
